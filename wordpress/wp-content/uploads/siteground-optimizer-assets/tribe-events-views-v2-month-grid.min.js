tribe.events=tribe.events||{},tribe.events.views=tribe.events.views||{},tribe.events.views.monthGrid={},function(b,a){'use strict';var c=b(document);a.selectors={grid:'[data-js="tribe-events-month-grid"]',row:'[data-js="tribe-events-month-grid-row"]',cell:'[data-js="tribe-events-month-grid-cell"]',focusable:'[tabindex]',focused:'[tabindex="0"]'},a.keyCode={END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40},a.isValidCell=function(a,b,c){return!isNaN(b)&&!isNaN(c)&&b>=0&&c>=0&&a&&a.length&&b<a.length&&c<a[b].length},a.getNextCell=function(h,c,d,f,g){var e=c+g,b=d+f;return a.isValidCell(h,e,b)?{row:e,col:b}:{row:c,col:d}},a.setFocusPointer=function(e,c,d){var b=e.data('tribeEventsState');return!!a.isValidCell(b.grid,c,d)&&(b.grid[b.currentRow][b.currentCol].attr('tabindex','-1'),b.grid[c][d].attr('tabindex','0'),b.currentRow=c,b.currentCol=d,e.data('tribeEventsState',b),!0)},a.focusCell=function(b,c,d){if(a.setFocusPointer(b,c,d)){var e=b.data('tribeEventsState');e.grid[c][d].focus()}},a.handleKeydown=function(f){var g=f.data.grid,e=g.data('tribeEventsState'),h=f.which||f.keyCode,c=e.currentRow,d=e.currentCol,b;switch(h){case a.keyCode.UP:b=a.getNextCell(e.grid,c,d,0,-1),c=b.row,d=b.col;break;case a.keyCode.DOWN:b=a.getNextCell(e.grid,c,d,0,1),c=b.row,d=b.col;break;case a.keyCode.LEFT:b=a.getNextCell(e.grid,c,d,-1,0),c=b.row,d=b.col;break;case a.keyCode.RIGHT:b=a.getNextCell(e.grid,c,d,1,0),c=b.row,d=b.col;break;case a.keyCode.HOME:f.ctrlKey&&(c=0),d=0;break;case a.keyCode.END:f.ctrlKey&&(c=e.grid.length-1),d=e.grid[e.currentRow].length-1;break;default:return}a.focusCell(g,c,d),f.preventDefault()},a.handleClick=function(f){for(var g=f.data.grid,e=g.data('tribeEventsState'),h=b(f.target).closest(a.selectors.focusable),c=0,d;c<e.grid.length;c++)for(d=0;d<e.grid[c].length;d++)if(e.grid[c][d].is(h)){a.focusCell(g,c,d);return}},a.initState=function(a){var b={grid:[],currentRow:0,currentCol:0};a.data('tribeEventsState',b)},a.setupGrid=function(d){var c=d.data('tribeEventsState');d.find(a.selectors.row).each(function(f,e){var d=[];b(e).find(a.selectors.cell).each(function(h,g){var e=b(g),f;e.is(a.selectors.focusable)?(e.is(a.selectors.focused)&&(c.currentRow=c.grid.length,c.currentCol=d.length),d.push(e)):(f=e.find(a.selectors.focusable),f.is(a.selectors.focusable)&&(e.is(a.selectors.focused)&&(c.currentRow=c.grid.length,c.currentCol=d.length),d.push(f)))}),d.length&&c.grid.push(d)}),d.data('tribeEventsState',c)},a.unbindEvents=function(a){a.off()},a.bindEvents=function(b){b.on('keydown',{grid:b},a.handleKeydown).on('click',{grid:b},a.handleClick)},a.deinit=function(c,e,f){var b=c.data.container,d=b.find(a.selectors.grid);a.unbindEvents(d),b.off('beforeAjaxSuccess.tribeEvents',a.deinit)},a.init=function(e,f,c,g){var b=c.find(a.selectors.grid),d;if(!b.length)return;a.initState(b),a.setupGrid(b),d=b.data('tribeEventsState'),a.setFocusPointer(b,d.currentRow,d.currentCol),a.bindEvents(b),c.on('beforeAjaxSuccess.tribeEvents',{container:c},a.deinit)},a.ready=function(){c.on('afterSetup.tribeEvents',tribe.events.views.manager.selectors.container,a.init)},b(a.ready)}(jQuery,tribe.events.views.monthGrid)