tribe.events=tribe.events||{},tribe.events.views=tribe.events.views||{},tribe.events.views.datepicker={},function(b,a){'use strict';var c=b(document);a.selectors={datepickerFormClass:'.tribe-events-c-top-bar__datepicker-form',datepickerContainer:'[data-js="tribe-events-top-bar-datepicker-container"]',datepickerDaysBody:'.datepicker-days tbody',input:'[data-js="tribe-events-top-bar-date"]',button:'[data-js="tribe-events-top-bar-datepicker-button"]',buttonOpenClass:'.tribe-events-c-top-bar__datepicker-button--open',dateInput:'[name="tribe-events-views[tribe-bar-date]"]',prevIconTemplate:'.tribe-events-c-top-bar__datepicker-template-prev-icon',nextIconTemplate:'.tribe-events-c-top-bar__datepicker-template-next-icon'},a.state={initialized:!1},a.options={container:null,daysOfWeekDisabled:[],maxViewMode:'decade',minViewMode:'month',orientation:'bottom left',showOnFocus:!1,templates:{leftArrow:'',rightArrow:''}},a.keyCode={ENTER:13},a.today=null,a.dateFormatMap={d:'dd',j:'d',m:'mm',n:'m',Y:'yyyy'},a.observer=null,a.padNumber=function(b){var a=b+'',c=a.length>1?'':'0';return c+a},a.request=function(b,a){var c={view_data:b,_wpnonce:a.data('view-rest-nonce')};tribe.events.views.manager.request(c,a)},a.createDateInputObj=function(c){var a=b('<input>');return a.attr({type:'hidden',name:'tribe-events-views[tribe-bar-date]',value:c}),a},a.submitRequest=function(c,d){var b={};b['tribe-bar-date']=d,a.request(b,c)},a.handleChangeDate=function(b){var c=b.data.container,d=b.date.getDate(),e=b.date.getMonth()+1,f=b.date.getFullYear(),g=a.padNumber(d),h=a.padNumber(e),i=[f,h,g].join('-');a.submitRequest(c,i)},a.handleChangeMonth=function(b){var e=b.data.container,c,d,f,g,h;b.date?(c=b.date.getMonth()+1,d=b.date.getFullYear()):(f=e.find(a.selectors.input).bootstrapDatepicker('getDate'),c=f.getMonth()+1,d=f.getFullYear()),g=a.padNumber(c),h=[d,g].join('-'),a.submitRequest(e,h)},a.handleKeyDown=function(b){if(b.keyCode!==a.keyCode.ENTER)return;b.data.input.bootstrapDatepicker().trigger('changeMonth')},a.handleShow=function(b){b.data.datepickerButton.addClass(a.selectors.buttonOpenClass.className())},a.handleHide=function(b){var c=b.data.datepickerButton,d=c.data('tribeEventsState');if(b.data.observer.disconnect(),d.isTarget){b.data.input.bootstrapDatepicker('show');return}c.removeClass(a.selectors.buttonOpenClass.className()).trigger('focus')},a.handleMousedown=function(d){var b=d.data.target,c=b.data('tribeEventsState'),e,f;if('touchstart'===d.type){e=b.hasClass(a.selectors.buttonOpenClass.className())?'hide':'show',f='hide'===e,c.isTarget=!1,b.data('tribeTapHide',f).data('tribeEventsState',c).off('mousedown',a.handleMousedown);return}c.isTarget=!0,b.data('tribeEventsState',c)},a.handleClick=function(c){var d=c.data.input,b=c.data.target,e=b.data('tribeEventsState'),f=b.hasClass(a.selectors.buttonOpenClass.className())?'hide':'show',g=b.data('tribeTapHide');if(g)return;e.isTarget=!1,b.data('tribeEventsState',e),d.bootstrapDatepicker(f),'show'===f&&d.trigger('focus')},a.handleMutation=function(c){var b=c.container;return function(c,d){c.forEach(function(c){'childList'===c.type&&b.find(a.selectors.datepickerDaysBody).is(c.target)&&c.addedNodes.length&&b.trigger('handleMutationMonthChange.tribeEvents')})}},a.setToday=function(b){var c=b;b.indexOf(' ')>=0&&(c=b.split(' ')[0]),a.today=new Date(c)},a.isSameAsToday=function(b,c){switch(c){case'year':return b.getFullYear()===a.today.getUTCFullYear();case'month':return a.isSameAsToday(b,'year')&&b.getMonth()===a.today.getUTCMonth();case'day':return a.isSameAsToday(b,'month')&&b.getDate()===a.today.getUTCDate();default:return!1}},a.isBeforeToday=function(b,c){switch(c){case'year':return b.getFullYear()<a.today.getUTCFullYear();case'month':return a.isBeforeToday(b,'year')||a.isSameAsToday(b,'year')&&b.getMonth()<a.today.getUTCMonth();case'day':return a.isBeforeToday(b,'month')||a.isSameAsToday(b,'month')&&b.getDate()<a.today.getUTCDate();default:return!1}},a.filterDayCells=function(b){if(a.isBeforeToday(b,'day'))return'past';if(a.isSameAsToday(b,'day'))return'current'},a.filterMonthCells=function(b){if(a.isBeforeToday(b,'month'))return'past';if(a.isSameAsToday(b,'month'))return'current'},a.filterYearCells=function(b){if(a.isBeforeToday(b,'year'))return'past';if(a.isSameAsToday(b,'year'))return'current'},a.convertDateFormat=function(c){var b=c;return Object.keys(a.dateFormatMap).forEach(function(c){b=b.replace(c,a.dateFormatMap[c])}),b},a.initDateFormat=function(b){var c=b.date_formats||{},d=c.compact,e=a.convertDateFormat(d);a.options.format=e},a.deinit=function(e,c,d){var b=e.data.container,f,g;b.trigger('beforeDatepickerDeinit.tribeEvents',[c,d]),f=b.find(a.selectors.input),g=b.find(a.selectors.button),f.bootstrapDatepicker('destroy').off(),g.off(),b.off('beforeAjaxSuccess.tribeEvents',a.deinit),b.trigger('afterDatepickerDeinit.tribeEvents',[c,d])},a.init=function(r,p,b,c){var d,e,k,j,h,f,l,m,n,o,g,q,i;b.trigger('beforeDatepickerInit.tribeEvents',[p,b,c]),d=b.find(a.selectors.input),e=b.find(a.selectors.button),k=b.find(a.selectors.prevIconTemplate).html(),j=b.find(a.selectors.nextIconTemplate).html(),h=c.slug,f='month'===h,l=f?'changeMonth':'changeDate',m=f?a.handleChangeMonth:a.handleChangeDate,n={isTarget:!1},a.observer=new MutationObserver(a.handleMutation({container:b})),a.setToday(c.today),a.initDateFormat(c),a.options.weekStart=c.start_of_week,a.options.container=b.find(a.selectors.datepickerContainer),a.options.minViewMode=f?'year':'month',o=window.tribe_l10n_datatables||{},g=o.datepicker||{},q=g.nextText||'Next',i=g.prevText||'Prev',a.options.templates.leftArrow=k+'<span class="tribe-common-a11y-visual-hide">'+i+'</span>',a.options.templates.rightArrow=j+'<span class="tribe-common-a11y-visual-hide">'+q+'</span>',a.options.beforeShowDay=a.filterDayCells,a.options.beforeShowMonth=a.filterMonthCells,a.options.beforeShowYear=a.filterYearCells,d.bootstrapDatepicker(a.options).on(l,{container:b},m).on('show',{datepickerButton:e},a.handleShow).on('hide',{datepickerButton:e,input:d,observer:a.observer},a.handleHide),f&&d.bootstrapDatepicker().on('keydown',{input:d},a.handleKeyDown),e.on('touchstart mousedown',{target:e},a.handleMousedown).on('click',{target:e,input:d},a.handleClick).data('tribeEventsState',n),b.on('beforeAjaxSuccess.tribeEvents',{container:b,viewSlug:h},a.deinit),b.trigger('afterDatepickerInit.tribeEvents',[p,b,c])},a.initDatepickerI18n=function(){var c=window.tribe_l10n_datatables||{},a=c.datepicker||{};a.dayNames&&(b.fn.bootstrapDatepicker.dates.en.days=a.dayNames),a.dayNamesShort&&(b.fn.bootstrapDatepicker.dates.en.daysShort=a.dayNamesShort),a.dayNamesMin&&(b.fn.bootstrapDatepicker.dates.en.daysMin=a.dayNamesMin),a.monthNames&&(b.fn.bootstrapDatepicker.dates.en.months=a.monthNames),a.monthNamesMin&&(b.fn.bootstrapDatepicker.dates.en.monthsShort=a.monthNamesMin),a.today&&(b.fn.bootstrapDatepicker.dates.en.today=a.today),a.clear&&(b.fn.bootstrapDatepicker.dates.en.clear=a.clear)},a.initDatepicker=function(){if(b.fn.datepicker&&b.fn.datepicker.noConflict){var c=b.fn.datepicker.noConflict();b.fn.bootstrapDatepicker=c,a.initDatepickerI18n(),a.state.initialized=!0}},a.ready=function(){a.initDatepicker(),a.state.initialized&&c.on('afterSetup.tribeEvents',tribe.events.views.manager.selectors.container,a.init)},b(a.ready)}(jQuery,tribe.events.views.datepicker)